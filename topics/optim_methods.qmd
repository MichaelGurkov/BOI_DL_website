---
title: "Optimization methods"
---

```{r set_up_python, echo=FALSE}
#|echo: FALSE

if (Sys.getenv("USERPROFILE") == "C:\\Users\\internet"){
  
  python_path = paste0("C:\\Users\\internet\\AppData\\Local",
                       "\\Programs\\Python\\Python312\\python.exe")
} else {
  
  python_path = paste0("C:\\Users\\Home\\AppData\\Local",
                       "\\Programs\\Python\\Python312\\python.exe")
}

reticulate::use_python(python_path)

```

```{python import_libraries}
#| code-fold: true
#| code-summary: "Show the code"


import pandas as pd

import numpy as np

import os


from func_package.tests import (test_forward_propagation,
test_backward_propagation, test_model)

from func_package.model import model

from func_package.utils import predict_nn

from sklearn.metrics import accuracy_score

# Plot predictions
import matplotlib.pyplot as plt

```


```{python import_data}

raw_data = pd.read_csv("data\\cluster_moons.csv")

X = raw_data.iloc[:,0:2].copy()

X = X.to_numpy().T.copy()

y = raw_data.iloc[:,2].copy()

y = y.to_numpy().reshape(1, -1).copy()

```

```{python plot_data}

plt.scatter(X.iloc[:,0],X.iloc[:,1], c=y)
plt.xlabel('Feature 1')
plt.ylabel('Feature 2')
plt.title('Scatter Plot of Feature 1 and Feature 2')
plt.show()


```



# Gradient descent


```{python}

layer_dims = [2, 4, 1]

gd_parameters, gd_costs = model(
    X, y, layer_dims,
    optimizer="gd",
    learning_rate=0.01,
    num_epochs=2000,
    batch_size=None,
    print_cost=True,
    print_every=200
)

```

```{python gd_predictions}

pred_gd = predict_nn(X, gd_parameters)

accuracy_score(pred_gd.flatten(),y.flatten())

```



# Stochastic gradient descent

# Momentum

# RMSProp

# Adam